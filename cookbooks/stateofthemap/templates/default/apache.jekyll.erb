# DO NOT EDIT - This file is being maintained by Chef

<VirtualHost *:80>
        ServerName <%= @year %>.stateofthemap.org
        ServerAlias <%= @year %>.stateofthemap.com <%= @year %>.sotm.org
        ServerAdmin webmaster@openstreetmap.org

        CustomLog /var/log/apache2/<%= @year %>.stateofthemap.org-access.log combined
        ErrorLog /var/log/apache2/<%= @year %>.stateofthemap.org-error.log

        RedirectPermanent /.well-known/acme-challenge/ http://acme.openstreetmap.org/.well-known/acme-challenge/
        RedirectPermanent / https://<%= @year %>.stateofthemap.org/
</VirtualHost>

<VirtualHost *:443>
        ServerName <%= @year %>.stateofthemap.com
        ServerAlias <%= @year %>.sotm.org
        ServerAdmin webmaster@openstreetmap.org

        CustomLog /var/log/apache2/<%= @year %>.stateofthemap.org-access.log combined
        ErrorLog /var/log/apache2/<%= @year %>.stateofthemap.org-error.log

        SSLEngine on
        SSLCertificateFile /etc/ssl/certs/<%= @year %>.stateofthemap.org.pem
        SSLCertificateKeyFile /etc/ssl/private/<%= @year %>.stateofthemap.org.key

        RedirectPermanent / https://<%= @year %>.stateofthemap.org/
</VirtualHost>

<VirtualHost *:443>
        ServerName <%= @year %>.stateofthemap.org
        ServerAdmin webmaster@openstreetmap.org

        CustomLog /var/log/apache2/<%= @year %>.stateofthemap.org-access.log combined
        ErrorLog /var/log/apache2/<%= @year %>.stateofthemap.org-error.log

        SSLEngine on
        SSLCertificateFile /etc/ssl/certs/<%= @year %>.stateofthemap.org.pem
        SSLCertificateKeyFile /etc/ssl/private/<%= @year %>.stateofthemap.org.key

        DocumentRoot /srv/stateofthemap/<%= @year %>.stateofthemap.org/_site

        ErrorDocument 404 /404.html

        ExpiresActive On
        ExpiresDefault "access plus 10 minutes"
</VirtualHost>

<Directory /srv/stateofthemap/<%= @year %>.stateofthemap.org/_site>
        Require all granted
</Directory>
